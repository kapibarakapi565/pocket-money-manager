<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>おこづかい管理アプリ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- モード選択 -->
        <div class="mode-selection" style="text-align: center; margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
            <h3 style="margin: 0 0 15px 0; color: #333;">📊 管理モード選択</h3>
            <div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 15px;">
                <button id="modeBtn1" class="mode-btn active" onclick="switchMode('personal')">個人管理</button>
                <button id="modeBtn2" class="mode-btn" onclick="switchMode('household')">家計管理</button>
            </div>
            <div id="userSelection" style="display: flex; gap: 10px; justify-content: center;">
                <button id="userBtn1" class="user-btn active" onclick="switchUser('user1')">夫</button>
                <button id="userBtn2" class="user-btn" onclick="switchUser('user2')">妻</button>
            </div>
        </div>
        
        <h1 id="appTitle">💰 おこづかい管理アプリ</h1>
        
        <!-- 個人管理セクション -->
        <div id="personalSection">
            <div class="summary-section">
                <div class="summary-card">
                    <h3>今月の予算</h3>
                    <p class="amount">¥0</p>
                </div>
                <div class="summary-card">
                    <h3>使った金額</h3>
                    <p class="amount" id="totalSpent">¥0</p>
                </div>
                <div class="summary-card">
                    <h3>残り予算</h3>
                    <p class="amount" id="remaining">¥0</p>
                </div>
                <div class="summary-card">
                    <h3>使用率</h3>
                    <p class="amount" id="usageRate">0%</p>
                </div>
            </div>
        </div>
        
        <!-- 家計管理セクション -->
        <div id="householdSection" style="display: none;">
            <div class="summary-section">
                <div class="summary-card">
                    <h3>家計予算</h3>
                    <p class="amount" id="householdBudget">¥0</p>
                </div>
                <div class="summary-card">
                    <h3>家計支出</h3>
                    <p class="amount" id="householdSpent">¥0</p>
                </div>
                <div class="summary-card">
                    <h3>残り予算</h3>
                    <p class="amount" id="householdRemaining">¥0</p>
                </div>
                <div class="summary-card">
                    <h3>貯蓄目標</h3>
                    <p class="amount" id="savingsGoal">¥0</p>
                </div>
            </div>
            
            <!-- 貯蓄目標設定 -->
            <div class="budget-section">
                <div class="section-title">💰 貯蓄目標設定</div>
                <div class="savings-management" style="margin-bottom: 20px; padding: 15px; background: #e8f5e8; border-radius: 8px; border: 2px solid #4CAF50;">
                    <h4 style="margin: 0 0 10px 0; color: #333;">🎯 今月の貯蓄目標</h4>
                    <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                        <input type="number" id="savingsGoalInput" placeholder="目標貯蓄額" class="amount-input" style="flex: 1;">
                        <button class="add-btn" onclick="setSavingsGoal()" style="background: #4CAF50;">貯蓄目標設定</button>
                    </div>
                    <div id="savingsProgress" style="margin-top: 10px; font-size: 14px; color: #666;">
                        <div id="savingsSummary">目標: ¥0 | 実績: ¥0 | 達成率: 0%</div>
                        <div style="margin-top: 8px;">
                            <div class="progress-bar" style="background: #e0e0e0; height: 12px;">
                                <div id="savingsProgressBar" class="progress-fill" style="width: 0%; background: linear-gradient(90deg, #2196F3 0%, #1976D2 100%);"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- リセット機能 -->
        <div class="reset-section" style="text-align: center; margin-bottom: 20px;">
            <button class="reset-btn monthly" onclick="resetMonthlyData()">📅 今月のデータをリセット</button>
            <button class="reset-btn all" onclick="resetAllData()">🗑️ すべてリセット</button>
        </div>
        
        <!-- 大枠予算設定 -->
        <div class="budget-section">
            <div class="section-title">💰 大枠予算設定</div>
            <div class="total-budget-management" style="margin-bottom: 20px; padding: 15px; background: #e8f5e8; border-radius: 8px; border: 2px solid #4CAF50;">
                <h4 style="margin: 0 0 10px 0; color: #333;">📋 今月の総予算</h4>
                <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                    <input type="number" id="totalBudgetInput" placeholder="総予算額" class="amount-input" style="flex: 1;">
                    <button class="add-btn" onclick="setTotalBudget()" style="background: #4CAF50;">総予算設定</button>
                </div>
                <div id="budgetAllocation" style="margin-top: 10px; font-size: 14px; color: #666;">
                    <div id="budgetSummary">総予算: ¥0 | 配分済み: ¥0 | 残り: ¥0</div>
                    <div style="margin-top: 8px;">
                        <div class="progress-bar" style="background: #e0e0e0; height: 12px;">
                            <div id="budgetAllocationBar" class="progress-fill" style="width: 0%; background: linear-gradient(90deg, #4CAF50 0%, #45a049 100%);"></div>
                        </div>
                        <div style="font-size: 12px; margin-top: 4px; color: #888;">
                            <span id="allocationPercentage">0%</span> 配分済み
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="budget-section">
            <div class="section-title">📊 カテゴリ別予算管理</div>
            
            <!-- カテゴリー追加フォーム -->
            <div class="category-management" style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                <h4 style="margin: 0 0 10px 0; color: #333;">🎯 新しいカテゴリーを追加</h4>
                <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                    <input type="text" id="newCategoryName" placeholder="カテゴリー名" class="category-input text-input">
                    <input type="number" id="newCategoryBudget" placeholder="予算額" class="amount-input">
                    <button class="add-btn" onclick="addCategory()">カテゴリー追加</button>
                </div>
                <div id="categoryBudgetWarning" style="margin-top: 8px; color: #f44336; font-size: 12px; display: none;">
                    ⚠️ 大枠予算を超えています
                </div>
            </div>
            
            <div class="table-container">
                <table id="budgetTable">
                    <thead>
                        <tr>
                            <th>カテゴリ</th>
                            <th>予算額</th>
                            <th>使用額</th>
                            <th>残額</th>
                            <th>進捗</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- カテゴリーは動的に生成 -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="budget-section">
            <div class="section-title">💸 支出記録</div>
            <div style="margin-bottom: 15px;">
                <input type="date" id="expenseDate" class="category-input date-input">
                <select id="expenseCategory" class="category-input select-input">
                    <!-- カテゴリーは動的に生成 -->
                </select>
                <input type="text" id="expenseDescription" placeholder="内容" class="category-input text-input">
                <input type="number" id="expenseAmount" placeholder="金額" class="amount-input">
                <button class="add-btn" onclick="addExpense()">追加</button>
            </div>
            <div id="expenseList"></div>
        </div>
        
        <div class="remaining-amount" id="remainingDisplay">
            残り予算: ¥0
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>